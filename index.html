<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–æ–≤–æ–π –õ–∞—É–Ω—á–µ—Ä</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --background-color: #ecf0f1;
            --text-color: #2c3e50;
            --card-color: #ffffff;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--primary-color);
            margin: 0;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
        }

        .theme-btn {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #fff;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .theme-btn:hover {
            transform: scale(1.2);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .game-card {
            background-color: var(--card-color);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .game-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .game-info {
            padding: 15px;
        }

        .game-title {
            margin: 0 0 10px 0;
            color: var(--primary-color);
        }

        .game-description {
            margin: 0;
            font-size: 14px;
            color: var(--text-color);
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–≥—Ä—ã */
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .game-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow: auto;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
        }

        /* –¢–µ–º—ã */
        .theme-default {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --background-color: #ecf0f1;
            --text-color: #2c3e50;
            --card-color: #ffffff;
        }

        .theme-dark {
            --primary-color: #9b59b6;
            --secondary-color: #8e44ad;
            --background-color: #2c3e50;
            --text-color: #ecf0f1;
            --card-color: #34495e;
        }

        .theme-ocean {
            --primary-color: #1abc9c;
            --secondary-color: #16a085;
            --background-color: #d1f2eb;
            --text-color: #0e6251;
            --card-color: #a3e4d7;
        }

        .theme-forest {
            --primary-color: #27ae60;
            --secondary-color: #219653;
            --background-color: #d5f5e3;
            --text-color: #196f3d;
            --card-color: #a9dfbf;
        }

        .theme-sunset {
            --primary-color: #e74c3c;
            --secondary-color: #c0392b;
            --background-color: #fadbd8;
            --text-color: #922b21;
            --card-color: #f5b7b1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä */
        #game-container {
            margin-top: 20px;
        }

        #snake-canvas, #tetris-canvas, #pong-canvas, #breakout-canvas {
            background-color: #f0f0f0;
            display: block;
            margin: 0 auto;
        }

        #tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            margin: 20px auto;
            width: 310px;
        }

        .tic-tac-toe-cell {
            width: 100px;
            height: 100px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 48px;
            cursor: pointer;
        }

        #memory-game {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            grid-template-rows: repeat(4, 100px);
            gap: 10px;
            margin: 20px auto;
            width: 440px;
        }

        .memory-card {
            width: 100px;
            height: 100px;
            background-color: #3498db;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }

        .memory-card.flipped {
            background-color: white;
            color: #2c3e50;
        }

        #hangman-container {
            text-align: center;
            margin-top: 20px;
        }

        #hangman-word {
            font-size: 32px;
            letter-spacing: 10px;
            margin: 20px 0;
        }

        #hangman-letters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-top: 20px;
        }

        .hangman-letter {
            width: 40px;
            height: 40px;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 5px;
        }

        .hangman-letter.used {
            background-color: #95a5a6;
            cursor: not-allowed;
        }

        #dino-container {
            position: relative;
            width: 600px;
            height: 200px;
            margin: 20px auto;
            overflow: hidden;
            background-color: #f0f0f0;
        }

        #dino {
            position: absolute;
            width: 50px;
            height: 50px;
            bottom: 0;
            left: 50px;
            background-color: #333;
        }

        #cactus {
            position: absolute;
            width: 20px;
            height: 40px;
            bottom: 0;
            right: 0;
            background-color: #27ae60;
        }
    </style>
</head>
<body class="theme-default">
    <div class="container">
        <header>
            <h1>–ò–≥—Ä–æ–≤–æ–π –õ–∞—É–Ω—á–µ—Ä</h1>
            <div class="theme-selector">
                <div class="theme-btn" style="background: #3498db;" onclick="changeTheme('theme-default')"></div>
                <div class="theme-btn" style="background: #9b59b6;" onclick="changeTheme('theme-dark')"></div>
                <div class="theme-btn" style="background: #1abc9c;" onclick="changeTheme('theme-ocean')"></div>
                <div class="theme-btn" style="background: #27ae60;" onclick="changeTheme('theme-forest')"></div>
                <div class="theme-btn" style="background: #e74c3c;" onclick="changeTheme('theme-sunset')"></div>
            </div>
        </header>

        <div class="games-grid">
            <!-- –ò–≥—Ä–∞ 1 -->
            <div class="game-card" onclick="launchGame('snake')">
                <img src="https://via.placeholder.com/300x150?text=–ó–º–µ–π–∫–∞" alt="–ó–º–µ–π–∫–∞" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–ó–º–µ–π–∫–∞</h3>
                    <p class="game-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–Ω–∞—è –∏–≥—Ä–∞</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 2 -->
            <div class="game-card" onclick="launchGame('tetris')">
                <img src="https://via.placeholder.com/300x150?text=–¢–µ—Ç—Ä–∏—Å" alt="–¢–µ—Ç—Ä–∏—Å" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–¢–µ—Ç—Ä–∏—Å</h3>
                    <p class="game-description">–°–æ–±–∏—Ä–∞–π—Ç–µ –ª–∏–Ω–∏–∏ –∏–∑ –ø–∞–¥–∞—é—â–∏—Ö —Ñ–∏–≥—É—Ä</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 3 -->
            <div class="game-card" onclick="launchGame('tic-tac-toe')">
                <img src="https://via.placeholder.com/300x150?text=–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏" alt="–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h3>
                    <p class="game-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 4 -->
            <div class="game-card" onclick="launchGame('memory')">
                <img src="https://via.placeholder.com/300x150?text=–ü–∞–º—è—Ç—å" alt="–ò–≥—Ä–∞ –Ω–∞ –ø–∞–º—è—Ç—å" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–ò–≥—Ä–∞ –Ω–∞ –ø–∞–º—è—Ç—å</h3>
                    <p class="game-description">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø–∞—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 5 -->
            <div class="game-card" onclick="launchGame('pong')">
                <img src="https://via.placeholder.com/300x150?text=–ü–∏–Ω–≥-–ø–æ–Ω–≥" alt="–ü–∏–Ω–≥-–ø–æ–Ω–≥" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–ü–∏–Ω–≥-–ø–æ–Ω–≥</h3>
                    <p class="game-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä–∫–∞–¥–∞ —Å —Ä–∞–∫–µ—Ç–∫–∞–º–∏</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 6 -->
            <div class="game-card" onclick="launchGame('hangman')">
                <img src="https://via.placeholder.com/300x150?text=–í–∏—Å–µ–ª–∏—Ü–∞" alt="–í–∏—Å–µ–ª–∏—Ü–∞" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–í–∏—Å–µ–ª–∏—Ü–∞</h3>
                    <p class="game-description">–£–≥–∞–¥–∞–π—Ç–µ —Å–ª–æ–≤–æ –ø–æ –±—É–∫–≤–∞–º</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 7 -->
            <div class="game-card" onclick="launchGame('breakout')">
                <img src="https://via.placeholder.com/300x150?text=–ê—Ä–∫–∞–Ω–æ–∏–¥" alt="–ê—Ä–∫–∞–Ω–æ–∏–¥" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–ê—Ä–∫–∞–Ω–æ–∏–¥</h3>
                    <p class="game-description">–†–∞–∑–±–µ–π—Ç–µ –≤—Å–µ –∫–∏—Ä–ø–∏—á–∏ –º—è—á–∏–∫–æ–º</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 8 -->
            <div class="game-card" onclick="launchGame('dino')">
                <img src="https://via.placeholder.com/300x150?text=Dino+Game" alt="Dino Game" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">Dino Game</h3>
                    <p class="game-description">–ë–µ–≥–∏—Ç–µ –∏ –ø—Ä—ã–≥–∞–π—Ç–µ —á–µ—Ä–µ–∑ –∫–∞–∫—Ç—É—Å—ã</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 9 -->
            <div class="game-card" onclick="launchGame('minesweeper')">
                <img src="https://via.placeholder.com/300x150?text=–°–∞–ø–µ—Ä" alt="–°–∞–ø–µ—Ä" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">–°–∞–ø–µ—Ä</h3>
                    <p class="game-description">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –º–∏–Ω—ã, –Ω–µ –ø–æ–¥–æ—Ä–≤–∞–≤—à–∏—Å—å</p>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ 10 -->
            <div class="game-card" onclick="launchGame('flappy')">
                <img src="https://via.placeholder.com/300x150?text=Flappy+Bird" alt="Flappy Bird" class="game-image">
                <div class="game-info">
                    <h3 class="game-title">Flappy Bird</h3>
                    <p class="game-description">–ü—Ä–æ–ª–µ—Ç–∏—Ç–µ –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–≥—Ä -->
    <div class="game-modal" id="game-modal">
        <div class="game-content">
            <button class="close-btn" onclick="closeGame()">√ó</button>
            <h2 id="game-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</h2>
            <div id="game-container"></div>
        </div>
    </div>

    <script>
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏
        function changeTheme(themeName) {
            document.body.className = themeName;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏
        let currentGame = null;

        function launchGame(gameName) {
            const modal = document.getElementById('game-modal');
            const gameTitle = document.getElementById('game-title');
            const gameContainer = document.getElementById('game-container');
            
            gameTitle.textContent = getGameTitle(gameName);
            gameContainer.innerHTML = '';
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –∏–≥—Ä—É, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
            if (currentGame && currentGame.stop) {
                currentGame.stop();
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
            currentGame = loadGame(gameName, gameContainer);
            
            modal.style.display = 'flex';
        }

        function closeGame() {
            document.getElementById('game-modal').style.display = 'none';
            if (currentGame && currentGame.stop) {
                currentGame.stop();
            }
        }

        function getGameTitle(gameName) {
            const titles = {
                'snake': '–ó–º–µ–π–∫–∞',
                'tetris': '–¢–µ—Ç—Ä–∏—Å',
                'tic-tac-toe': '–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏',
                'memory': '–ò–≥—Ä–∞ –Ω–∞ –ø–∞–º—è—Ç—å',
                'pong': '–ü–∏–Ω–≥-–ø–æ–Ω–≥',
                'hangman': '–í–∏—Å–µ–ª–∏—Ü–∞',
                'breakout': '–ê—Ä–∫–∞–Ω–æ–∏–¥',
                'dino': 'Dino Game',
                'minesweeper': '–°–∞–ø–µ—Ä',
                'flappy': 'Flappy Bird'
            };
            return titles[gameName] || gameName;
        }

        function loadGame(gameName, container) {
            switch(gameName) {
                case 'snake':
                    return loadSnakeGame(container);
                case 'tetris':
                    return loadTetrisGame(container);
                case 'tic-tac-toe':
                    return loadTicTacToeGame(container);
                case 'memory':
                    return loadMemoryGame(container);
                case 'pong':
                    return loadPongGame(container);
                case 'hangman':
                    return loadHangmanGame(container);
                case 'breakout':
                    return loadBreakoutGame(container);
                case 'dino':
                    return loadDinoGame(container);
                case 'minesweeper':
                    return loadMinesweeperGame(container);
                case 'flappy':
                    return loadFlappyGame(container);
                default:
                    container.innerHTML = '<p>–ò–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</p>';
                    return null;
            }
        }

        // –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–≥—Ä

        function loadSnakeGame(container) {
            container.innerHTML = `
                <canvas id="snake-canvas" width="400" height="400"></canvas>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç—Ä–µ–ª–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</p>
            `;
            
            const canvas = document.getElementById('snake-canvas');
            const ctx = canvas.getContext('2d');
            
            const gridSize = 20;
            const tileCount = canvas.width / gridSize;
            
            let snake = [{x: 10, y: 10}];
            let food = {x: 5, y: 5};
            let xVelocity = 0;
            let yVelocity = 0;
            let score = 0;
            let gameSpeed = 100;
            let gameLoop;
            
            function drawGame() {
                // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –†–∏—Å—É–µ–º –∑–º–µ—é
                ctx.fillStyle = 'green';
                snake.forEach(part => {
                    ctx.fillRect(part.x * gridSize, part.y * gridSize, gridSize-2, gridSize-2);
                });
                
                // –†–∏—Å—É–µ–º –µ–¥—É
                ctx.fillStyle = 'red';
                ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize-2, gridSize-2);
                
                // –†–∏—Å—É–µ–º —Å—á–µ—Ç
                ctx.fillStyle = 'black';
                ctx.font = '20px Arial';
                ctx.fillText('–°—á–µ—Ç: ' + score, 10, 20);
            }
            
            function moveSnake() {
                const head = {x: snake[0].x + xVelocity, y: snake[0].y + yVelocity};
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
                if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                    gameOver();
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å —Å–æ–±–æ–π
                for (let i = 1; i < snake.length; i++) {
                    if (head.x === snake[i].x && head.y === snake[i].y) {
                        gameOver();
                        return;
                    }
                }
                
                snake.unshift(head);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—ä–µ–¥–µ–Ω–∏–µ –µ–¥—ã
                if (head.x === food.x && head.y === food.y) {
                    score++;
                    placeFood();
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∂–¥—ã–µ 5 –æ—á–∫–æ–≤
                    if (score % 5 === 0 && gameSpeed > 50) {
                        gameSpeed -= 10;
                        clearInterval(gameLoop);
                        gameLoop = setInterval(gameStep, gameSpeed);
                    }
                } else {
                    snake.pop();
                }
            }
            
            function placeFood() {
                food = {
                    x: Math.floor(Math.random() * tileCount),
                    y: Math.floor(Math.random() * tileCount)
                };
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –µ–¥–∞ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–∞ –∑–º–µ–µ
                for (let i = 0; i < snake.length; i++) {
                    if (food.x === snake[i].x && food.y === snake[i].y) {
                        placeFood();
                        return;
                    }
                }
            }
            
            function gameStep() {
                moveSnake();
                drawGame();
            }
            
            function gameOver() {
                clearInterval(gameLoop);
                alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ' + score);
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', function(e) {
                switch(e.key) {
                    case 'ArrowUp':
                        if (yVelocity !== 1) {
                            xVelocity = 0;
                            yVelocity = -1;
                        }
                        break;
                    case 'ArrowDown':
                        if (yVelocity !== -1) {
                            xVelocity = 0;
                            yVelocity = 1;
                        }
                        break;
                    case 'ArrowLeft':
                        if (xVelocity !== 1) {
                            xVelocity = -1;
                            yVelocity = 0;
                        }
                        break;
                    case 'ArrowRight':
                        if (xVelocity !== -1) {
                            xVelocity = 1;
                            yVelocity = 0;
                        }
                        break;
                }
            });
            
            placeFood();
            gameLoop = setInterval(gameStep, gameSpeed);
            
            return {
                stop: function() {
                    clearInterval(gameLoop);
                }
            };
        }

        function loadTetrisGame(container) {
            container.innerHTML = `
                <canvas id="tetris-canvas" width="300" height="600"></canvas>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç—Ä–µ–ª–∫–∏ (–≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ - –¥–≤–∏–∂–µ–Ω–∏–µ, –≤–≤–µ—Ä—Ö - –ø–æ–≤–æ—Ä–æ—Ç, –≤–Ω–∏–∑ - —É—Å–∫–æ—Ä–µ–Ω–∏–µ)</p>
            `;
            
            const canvas = document.getElementById('tetris-canvas');
            const ctx = canvas.getContext('2d');
            
            const blockSize = 30;
            const cols = canvas.width / blockSize;
            const rows = canvas.height / blockSize;
            
            let score = 0;
            let gameOver = false;
            let board = createBoard();
            let piece = null;
            let dropCounter = 0;
            let dropInterval = 1000;
            let lastTime = 0;
            let animationId;
            
            // –§–∏–≥—É—Ä—ã —Ç–µ—Ç—Ä–∏—Å–∞
            const pieces = [
                { shape: [[1, 1, 1, 1]], color: '#00FFFF' }, // I
                { shape: [[1, 1, 1], [0, 1, 0]], color: '#800080' }, // T
                { shape: [[1, 1, 1], [1, 0, 0]], color: '#FF7F00' }, // L
                { shape: [[1, 1, 1], [0, 0, 1]], color: '#0000FF' }, // J
                { shape: [[1, 1], [1, 1]], color: '#FFFF00' }, // O
                { shape: [[0, 1, 1], [1, 1, 0]], color: '#00FF00' }, // S
                { shape: [[1, 1, 0], [0, 1, 1]], color: '#FF0000' } // Z
            ];
            
            function createBoard() {
                return Array.from(Array(rows), () => Array(cols).fill(0));
            }
            
            function draw() {
                // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
                ctx.fillStyle = '#000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –†–∏—Å—É–µ–º –¥–æ—Å–∫—É
                board.forEach((row, y) => {
                    row.forEach((value, x) => {
                        if (value) {
                            ctx.fillStyle = value;
                            ctx.fillRect(x * blockSize, y * blockSize, blockSize, blockSize);
                            ctx.strokeStyle = '#000';
                            ctx.strokeRect(x * blockSize, y * blockSize, blockSize, blockSize);
                        }
                    });
                });
                
                // –†–∏—Å—É–µ–º —Ç–µ–∫—É—â—É—é —Ñ–∏–≥—É—Ä—É
                if (piece) {
                    piece.shape.forEach((row, y) => {
                        row.forEach((value, x) => {
                            if (value) {
                                ctx.fillStyle = piece.color;
                                ctx.fillRect(
                                    (piece.position.x + x) * blockSize,
                                    (piece.position.y + y) * blockSize,
                                    blockSize,
                                    blockSize
                                );
                                ctx.strokeStyle = '#000';
                                ctx.strokeRect(
                                    (piece.position.x + x) * blockSize,
                                    (piece.position.y + y) * blockSize,
                                    blockSize,
                                    blockSize
                                );
                            }
                        });
                    });
                }
                
                // –†–∏—Å—É–µ–º —Å—á–µ—Ç
                ctx.fillStyle = '#FFF';
                ctx.font = '20px Arial';
                ctx.fillText('–°—á–µ—Ç: ' + score, 10, 20);
            }
            
            function createPiece() {
                const randomIndex = Math.floor(Math.random() * pieces.length);
                const newPiece = {
                    shape: pieces[randomIndex].shape,
                    color: pieces[randomIndex].color,
                    position: { x: Math.floor(cols / 2) - 1, y: 0 }
                };
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–∏–≥—Ä—ã—à
                if (collide(newPiece)) {
                    gameOver = true;
                    alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ' + score);
                    return null;
                }
                
                return newPiece;
            }
            
            function collide(piece) {
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x] !== 0 &&
                            (board[y + piece.position.y] &&
                            board[y + piece.position.y][x + piece.position.x]) !== 0) {
                            return true;
                        }
                    }
                }
                return false;
            }
            
            function merge() {
                piece.shape.forEach((row, y) => {
                    row.forEach((value, x) => {
                        if (value) {
                            board[y + piece.position.y][x + piece.position.x] = piece.color;
                        }
                    });
                });
            }
            
            function rotate() {
                const rotated = [];
                for (let i = 0; i < piece.shape[0].length; i++) {
                    const row = [];
                    for (let j = piece.shape.length - 1; j >= 0; j--) {
                        row.push(piece.shape[j][i]);
                    }
                    rotated.push(row);
                }
                
                const originalShape = piece.shape;
                piece.shape = rotated;
                if (collide(piece)) {
                    piece.shape = originalShape;
                }
            }
            
            function clearLines() {
                let linesCleared = 0;
                
                outer: for (let y = rows - 1; y >= 0; y--) {
                    for (let x = 0; x < cols; x++) {
                        if (board[y][x] === 0) {
                            continue outer;
                        }
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
                    const row = board.splice(y, 1)[0].fill(0);
                    board.unshift(row);
                    y++; // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç—É –∂–µ —Å—Ç—Ä–æ–∫—É —Å–Ω–æ–≤–∞
                    
                    linesCleared++;
                }
                
                // –ù–∞—á–∏—Å–ª—è–µ–º –æ—á–∫–∏
                if (linesCleared > 0) {
                    score += linesCleared * 100;
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∂–¥—ã–µ 5 –ª–∏–Ω–∏–π
                    if (score % 500 === 0 && dropInterval > 200) {
                        dropInterval -= 100;
                    }
                }
            }
            
            function update(time = 0) {
                if (gameOver) {
                    cancelAnimationFrame(animationId);
                    return;
                }
                
                const deltaTime = time - lastTime;
                lastTime = time;
                
                dropCounter += deltaTime;
                if (dropCounter > dropInterval) {
                    moveDown();
                    dropCounter = 0;
                }
                
                draw();
                animationId = requestAnimationFrame(update);
            }
            
            function moveDown() {
                if (!piece) return;
                
                piece.position.y++;
                if (collide(piece)) {
                    piece.position.y--;
                    merge();
                    clearLines();
                    piece = createPiece();
                }
                dropCounter = 0;
            }
            
            function moveLeft() {
                if (!piece) return;
                
                piece.position.x--;
                if (collide(piece)) {
                    piece.position.x++;
                }
            }
            
            function moveRight() {
                if (!piece) return;
                
                piece.position.x++;
                if (collide(piece)) {
                    piece.position.x--;
                }
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', event => {
                if (gameOver) return;
                
                switch(event.key) {
                    case 'ArrowLeft':
                        moveLeft();
                        break;
                    case 'ArrowRight':
                        moveRight();
                        break;
                    case 'ArrowDown':
                        moveDown();
                        break;
                    case 'ArrowUp':
                        rotate();
                        break;
                }
            });
            
            piece = createPiece();
            update();
            
            return {
                stop: function() {
                    cancelAnimationFrame(animationId);
                }
            };
        }

        function loadTicTacToeGame(container) {
            container.innerHTML = `
                <div id="tic-tac-toe-board"></div>
                <button onclick="resetTicTacToe()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <p id="tic-tac-toe-status">–•–æ–¥: X</p>
            `;
            
            const board = document.getElementById('tic-tac-toe-board');
            const status = document.getElementById('tic-tac-toe-status');
            let currentPlayer = 'X';
            let gameState = ['', '', '', '', '', '', '', '', ''];
            let gameActive = true;
            
            const winningConditions = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6]             // diagonals
            ];
            
            function handleCellClick(e) {
                const clickedCell = e.target;
                const clickedCellIndex = parseInt(clickedCell.getAttribute('data-index'));
                
                if (gameState[clickedCellIndex] !== '' || !gameActive) return;
                
                gameState[clickedCellIndex] = currentPlayer;
                clickedCell.textContent = currentPlayer;
                clickedCell.style.cursor = 'default';
                
                checkResult();
            }
            
            function checkResult() {
                let roundWon = false;
                
                for (let i = 0; i < winningConditions.length; i++) {
                    const [a, b, c] = winningConditions[i];
                    
                    if (gameState[a] === '' || gameState[b] === '' || gameState[c] === '') continue;
                    
                    if (gameState[a] === gameState[b] && gameState[b] === gameState[c]) {
                        roundWon = true;
                        break;
                    }
                }
                
                if (roundWon) {
                    status.textContent = `–ò–≥—Ä–æ–∫ ${currentPlayer} –ø–æ–±–µ–¥–∏–ª!`;
                    gameActive = false;
                    return;
                }
                
                if (!gameState.includes('')) {
                    status.textContent = '–ù–∏—á—å—è!';
                    gameActive = false;
                    return;
                }
                
                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                status.textContent = `–•–æ–¥: ${currentPlayer}`;
            }
            
            function resetGame() {
                currentPlayer = 'X';
                gameState = ['', '', '', '', '', '', '', '', ''];
                gameActive = true;
                status.textContent = `–•–æ–¥: ${currentPlayer}`;
                
                document.querySelectorAll('.tic-tac-toe-cell').forEach(cell => {
                    cell.textContent = '';
                    cell.style.cursor = 'pointer';
                });
            }
            
            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = 'tic-tac-toe-cell';
                cell.setAttribute('data-index', i);
                cell.addEventListener('click', handleCellClick);
                board.appendChild(cell);
            }
            
            // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é reset –¥–æ—Å—Ç—É–ø–Ω–æ–π –≥–ª–æ–±–∞–ª—å–Ω–æ
            window.resetTicTacToe = resetGame;
            
            return {
                stop: function() {
                    // –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç—Ç–æ–π –∏–≥—Ä—ã
                }
            };
        }

        function loadMemoryGame(container) {
            container.innerHTML = `
                <div id="memory-game"></div>
                <p id="memory-status">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø–∞—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫</p>
            `;
            
            const gameContainer = document.getElementById('memory-game');
            const status = document.getElementById('memory-status');
            
            const emojis = ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº'];
            const cards = [...emojis, ...emojis];
            
            let flippedCards = [];
            let matchedCards = [];
            let canFlip = true;
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
            cards.sort(() => 0.5 - Math.random());
            
            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ
            cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.setAttribute('data-index', index);
                card.textContent = emoji;
                card.style.display = 'none';
                card.addEventListener('click', flipCard);
                gameContainer.appendChild(card);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ 3 —Å–µ–∫—É–Ω–¥—ã –≤ –Ω–∞—á–∞–ª–µ
            showAllCards();
            setTimeout(hideAllCards, 3000);
            
            function showAllCards() {
                document.querySelectorAll('.memory-card').forEach(card => {
                    card.style.display = 'flex';
                });
            }
            
            function hideAllCards() {
                document.querySelectorAll('.memory-card:not(.matched)').forEach(card => {
                    card.style.display = 'flex';
                    card.textContent = '?';
                });
                canFlip = true;
            }
            
            function flipCard() {
                if (!canFlip || flippedCards.length >= 2 || this.classList.contains('flipped')) return;
                
                const index = this.getAttribute('data-index');
                this.textContent = cards[index];
                this.classList.add('flipped');
                flippedCards.push(this);
                
                if (flippedCards.length === 2) {
                    canFlip = false;
                    checkForMatch();
                }
            }
            
            function checkForMatch() {
                const [card1, card2] = flippedCards;
                const index1 = card1.getAttribute('data-index');
                const index2 = card2.getAttribute('data-index');
                
                if (cards[index1] === cards[index2]) {
                    // –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ–≤–ø–∞–ª–∏
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    matchedCards.push(card1, card2);
                    
                    flippedCards = [];
                    canFlip = true;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–∫–æ–Ω—á–µ–Ω–∞ –ª–∏ –∏–≥—Ä–∞
                    if (matchedCards.length === cards.length) {
                        status.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –Ω–∞—à–ª–∏ –≤—Å–µ –ø–∞—Ä—ã!';
                    }
                } else {
                    // –ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–ª–∏
                    setTimeout(() => {
                        card1.textContent = '?';
                        card2.textContent = '?';
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        flippedCards = [];
                        canFlip = true;
                    }, 1000);
                }
            }
            
            return {
                stop: function() {
                    // –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç—Ç–æ–π –∏–≥—Ä—ã
                }
            };
        }

        function loadPongGame(container) {
            container.innerHTML = `
                <canvas id="pong-canvas" width="600" height="400"></canvas>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: W/S - –ª–µ–≤–∞—è —Ä–∞–∫–µ—Ç–∫–∞, —Å—Ç—Ä–µ–ª–∫–∏ –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑ - –ø—Ä–∞–≤–∞—è —Ä–∞–∫–µ—Ç–∫–∞</p>
            `;
            
            const canvas = document.getElementById('pong-canvas');
            const ctx = canvas.getContext('2d');
            
            const paddleWidth = 10;
            const paddleHeight = 100;
            const ballSize = 10;
            
            let leftPaddleY = canvas.height / 2 - paddleHeight / 2;
            let rightPaddleY = canvas.height / 2 - paddleHeight / 2;
            let ballX = canvas.width / 2;
            let ballY = canvas.height / 2;
            let ballSpeedX = 5;
            let ballSpeedY = 5;
            
            let leftScore = 0;
            let rightScore = 0;
            
            let upPressed = false;
            let downPressed = false;
            let wPressed = false;
            let sPressed = false;
            
            let animationId;
            
            function draw() {
                // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
                ctx.fillStyle = 'black';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –†–∏—Å—É–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é
                ctx.strokeStyle = 'white';
                ctx.setLineDash([5, 15]);
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 0);
                ctx.lineTo(canvas.width / 2, canvas.height);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // –†–∏—Å—É–µ–º —Ä–∞–∫–µ—Ç–∫–∏
                ctx.fillStyle = 'white';
                ctx.fillRect(0, leftPaddleY, paddleWidth, paddleHeight);
                ctx.fillRect(canvas.width - paddleWidth, rightPaddleY, paddleWidth, paddleHeight);
                
                // –†–∏—Å—É–µ–º –º—è—á
                ctx.beginPath();
                ctx.arc(ballX, ballY, ballSize, 0, Math.PI * 2);
                ctx.fill();
                
                // –†–∏—Å—É–µ–º —Å—á–µ—Ç
                ctx.font = '32px Arial';
                ctx.fillText(leftScore, canvas.width / 4, 50);
                ctx.fillText(rightScore, 3 * canvas.width / 4, 50);
            }
            
            function update() {
                // –î–≤–∏–≥–∞–µ–º –º—è—á
                ballX += ballSpeedX;
                ballY += ballSpeedY;
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã
                if (ballY - ballSize < 0 || ballY + ballSize > canvas.height) {
                    ballSpeedY = -ballSpeedY;
                }
                
                // –û—Ç—Å–∫–æ–∫ –æ—Ç —Ä–∞–∫–µ—Ç–æ–∫
                if (
                    ballX - ballSize < paddleWidth &&
                    ballY > leftPaddleY &&
                    ballY < leftPaddleY + paddleHeight
                ) {
                    ballSpeedX = -ballSpeedX * 1.1; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Å–ª–µ –æ—Ç—Å–∫–æ–∫–∞
                    ballSpeedY *= 1.1;
                }
                
                if (
                    ballX + ballSize > canvas.width - paddleWidth &&
                    ballY > rightPaddleY &&
                    ballY < rightPaddleY + paddleHeight
                ) {
                    ballSpeedX = -ballSpeedX * 1.1;
                    ballSpeedY *= 1.1;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≥–æ–ª
                if (ballX < 0) {
                    rightScore++;
                    resetBall();
                }
                
                if (ballX > canvas.width) {
                    leftScore++;
                    resetBall();
                }
                
                // –î–≤–∏–≥–∞–µ–º —Ä–∞–∫–µ—Ç–∫–∏
                if (upPressed && rightPaddleY > 0) {
                    rightPaddleY -= 7;
                }
                
                if (downPressed && rightPaddleY < canvas.height - paddleHeight) {
                    rightPaddleY += 7;
                }
                
                if (wPressed && leftPaddleY > 0) {
                    leftPaddleY -= 7;
                }
                
                if (sPressed && leftPaddleY < canvas.height - paddleHeight) {
                    leftPaddleY += 7;
                }
            }
            
            function resetBall() {
                ballX = canvas.width / 2;
                ballY = canvas.height / 2;
                ballSpeedX = 5 * (Math.random() > 0.5 ? 1 : -1);
                ballSpeedY = 5 * (Math.random() > 0.5 ? 1 : -1);
            }
            
            function gameLoop() {
                update();
                draw();
                animationId = requestAnimationFrame(gameLoop);
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', function(e) {
                switch(e.key) {
                    case 'ArrowUp':
                        upPressed = true;
                        break;
                    case 'ArrowDown':
                        downPressed = true;
                        break;
                    case 'w':
                        wPressed = true;
                        break;
                    case 's':
                        sPressed = true;
                        break;
                }
            });
            
            document.addEventListener('keyup', function(e) {
                switch(e.key) {
                    case 'ArrowUp':
                        upPressed = false;
                        break;
                    case 'ArrowDown':
                        downPressed = false;
                        break;
                    case 'w':
                        wPressed = false;
                        break;
                    case 's':
                        sPressed = false;
                        break;
                }
            });
            
            gameLoop();
            
            return {
                stop: function() {
                    cancelAnimationFrame(animationId);
                }
            };
        }

        function loadHangmanGame(container) {
            container.innerHTML = `
                <div id="hangman-container">
                    <h3>–í–∏—Å–µ–ª–∏—Ü–∞</h3>
                    <div id="hangman-drawing" style="height: 150px; margin: 20px 0;"></div>
                    <div id="hangman-word"></div>
                    <div id="hangman-letters"></div>
                    <button onclick="resetHangman()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                    <p id="hangman-message"></p>
                </div>
            `;
            
            const words = ['–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï', '–ö–û–ú–ü–¨–Æ–¢–ï–†', '–ê–õ–ì–û–†–ò–¢–ú', '–ò–ù–¢–ï–†–ù–ï–¢', '–ë–†–ê–£–ó–ï–†', '–ö–õ–ê–í–ò–ê–¢–£–†–ê', '–ú–û–ù–ò–¢–û–†', '–°–ï–†–í–ï–†'];
            let selectedWord = '';
            let guessedLetters = [];
            let wrongAttempts = 0;
            const maxAttempts = 6;
            
            const wordDisplay = document.getElementById('hangman-word');
            const lettersContainer = document.getElementById('hangman-letters');
            const drawing = document.getElementById('hangman-drawing');
            const message = document.getElementById('hangman-message');
            
            function initGame() {
                selectedWord = words[Math.floor(Math.random() * words.length)];
                guessedLetters = [];
                wrongAttempts = 0;
                
                updateWordDisplay();
                createLetters();
                updateDrawing();
                message.textContent = '';
            }
            
            function updateWordDisplay() {
                wordDisplay.textContent = selectedWord
                    .split('')
                    .map(letter => guessedLetters.includes(letter) ? letter : '_')
                    .join(' ');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–±–µ–¥—É
                if (!wordDisplay.textContent.includes('_')) {
                    message.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!';
                    disableLetters();
                }
            }
            
            function createLetters() {
                lettersContainer.innerHTML = '';
                
                for (let i = 0; i < 33; i++) {
                    const letter = String.fromCharCode(1040 + i); // –†—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã –æ—Ç –ê –¥–æ –Ø
                    
                    const letterElement = document.createElement('div');
                    letterElement.className = 'hangman-letter';
                    letterElement.textContent = letter;
                    letterElement.addEventListener('click', () => guessLetter(letter));
                    
                    lettersContainer.appendChild(letterElement);
                }
            }
            
            function guessLetter(letter) {
                if (guessedLetters.includes(letter) || wrongAttempts >= maxAttempts) return;
                
                guessedLetters.push(letter);
                
                if (selectedWord.includes(letter)) {
                    updateWordDisplay();
                } else {
                    wrongAttempts++;
                    updateDrawing();
                    
                    if (wrongAttempts >= maxAttempts) {
                        message.textContent = `–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°–ª–æ–≤–æ –±—ã–ª–æ: ${selectedWord}`;
                        disableLetters();
                    }
                }
                
                // –ü–æ–º–µ—á–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é –±—É–∫–≤—É
                const letterElements = lettersContainer.querySelectorAll('.hangman-letter');
                letterElements.forEach(el => {
                    if (el.textContent === letter) {
                        el.classList.add('used');
                    }
                });
            }
            
            function updateDrawing() {
                drawing.innerHTML = '';
                const ctx = drawing.getContext('2d');
                
                // –†–∏—Å—É–µ–º –≤–∏—Å–µ–ª–∏—Ü—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫
                if (wrongAttempts >= 1) {
                    // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
                    ctx.fillStyle = '#8B4513';
                    ctx.fillRect(50, 130, 100, 20);
                }
                
                if (wrongAttempts >= 2) {
                    // –°—Ç–æ–ª–±
                    ctx.fillRect(100, 30, 10, 100);
                }
                
                if (wrongAttempts >= 3) {
                    // –ü–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–∞
                    ctx.fillRect(100, 30, 60, 10);
                }
                
                if (wrongAttempts >= 4) {
                    // –í–µ—Ä–µ–≤–∫–∞
                    ctx.fillStyle = '#000';
                    ctx.fillRect(155, 30, 2, 20);
                }
                
                if (wrongAttempts >= 5) {
                    // –ì–æ–ª–æ–≤–∞
                    ctx.beginPath();
                    ctx.arc(156, 62, 10, 0, Math.PI * 2);
                    ctx.stroke();
                }
                
                if (wrongAttempts >= 6) {
                    // –¢–µ–ª–æ
                    ctx.beginPath();
                    ctx.moveTo(156, 72);
                    ctx.lineTo(156, 110);
                    ctx.stroke();
                    
                    // –†—É–∫–∏
                    ctx.beginPath();
                    ctx.moveTo(156, 80);
                    ctx.lineTo(136, 90);
                    ctx.moveTo(156, 80);
                    ctx.lineTo(176, 90);
                    ctx.stroke();
                    
                    // –ù–æ–≥–∏
                    ctx.beginPath();
                    ctx.moveTo(156, 110);
                    ctx.lineTo(136, 130);
                    ctx.moveTo(156, 110);
                    ctx.lineTo(176, 130);
                    ctx.stroke();
                }
            }
            
            function disableLetters() {
                const letterElements = lettersContainer.querySelectorAll('.hangman-letter');
                letterElements.forEach(el => {
                    el.classList.add('used');
                });
            }
            
            // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é reset –¥–æ—Å—Ç—É–ø–Ω–æ–π –≥–ª–æ–±–∞–ª—å–Ω–æ
            window.resetHangman = initGame;
            
            initGame();
            
            return {
                stop: function() {
                    // –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç—Ç–æ–π –∏–≥—Ä—ã
                }
            };
        }

        function loadBreakoutGame(container) {
            container.innerHTML = `
                <canvas id="breakout-canvas" width="480" height="320"></canvas>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç—Ä–µ–ª–∫–∏ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ</p>
            `;
            
            const canvas = document.getElementById('breakout-canvas');
            const ctx = canvas.getContext('2d');
            
            const brickRowCount = 5;
            const brickColumnCount = 9;
            const brickWidth = 50;
            const brickHeight = 20;
            const brickPadding = 10;
            const brickOffsetTop = 30;
            const brickOffsetLeft = 30;
            
            const paddleHeight = 10;
            const paddleWidth = 75;
            
            const ballRadius = 10;
            
            let score = 0;
            let lives = 3;
            let animationId;
            
            // –°–æ–∑–¥–∞–µ–º –∫–∏—Ä–ø–∏—á–∏
            const bricks = [];
            for (let c = 0; c < brickColumnCount; c++) {
                bricks[c] = [];
                for (let r = 0; r < brickRowCount; r++) {
                    bricks[c][r] = { x: 0, y: 0, status: 1 };
                }
            }
            
            // –ú—è—á
            let ball = {
                x: canvas.width / 2,
                y: canvas.height - 30,
                dx: 4,
                dy: -4
            };
            
            // –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
            let paddle = {
                x: (canvas.width - paddleWidth) / 2,
                y: canvas.height - paddleHeight - 10
            };
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            let rightPressed = false;
            let leftPressed = false;
            
            function drawBricks() {
                for (let c = 0; c < brickColumnCount; c++) {
                    for (let r = 0; r < brickRowCount; r++) {
                        if (bricks[c][r].status === 1) {
                            const brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
                            const brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
                            
                            bricks[c][r].x = brickX;
                            bricks[c][r].y = brickY;
                            
                            ctx.beginPath();
                            ctx.rect(brickX, brickY, brickWidth, brickHeight);
                            ctx.fillStyle = `hsl(${r * 60}, 100%, 50%)`;
                            ctx.fill();
                            ctx.closePath();
                        }
                    }
                }
            }
            
            function drawBall() {
                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ballRadius, 0, Math.PI * 2);
                ctx.fillStyle = '#0095DD';
                ctx.fill();
                ctx.closePath();
            }
            
            function drawPaddle() {
                ctx.beginPath();
                ctx.rect(paddle.x, paddle.y, paddleWidth, paddleHeight);
                ctx.fillStyle = '#0095DD';
                ctx.fill();
                ctx.closePath();
            }
            
            function drawScore() {
                ctx.font = '16px Arial';
                ctx.fillStyle = '#0095DD';
                ctx.fillText('–°—á–µ—Ç: ' + score, 8, 20);
            }
            
            function drawLives() {
                ctx.font = '16px Arial';
                ctx.fillStyle = '#0095DD';
                ctx.fillText('–ñ–∏–∑–Ω–∏: ' + lives, canvas.width - 65, 20);
            }
            
            function collisionDetection() {
                for (let c = 0; c < brickColumnCount; c++) {
                    for (let r = 0; r < brickRowCount; r++) {
                        const brick = bricks[c][r];
                        if (brick.status === 1) {
                            if (
                                ball.x > brick.x &&
                                ball.x < brick.x + brickWidth &&
                                ball.y > brick.y &&
                                ball.y < brick.y + brickHeight
                            ) {
                                ball.dy = -ball.dy;
                                brick.status = 0;
                                score++;
                                
                                if (score === brickRowCount * brickColumnCount) {
                                    alert('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!');
                                    document.location.reload();
                                }
                            }
                        }
                    }
                }
            }
            
            function movePaddle() {
                if (rightPressed && paddle.x < canvas.width - paddleWidth) {
                    paddle.x += 7;
                } else if (leftPressed && paddle.x > 0) {
                    paddle.x -= 7;
                }
            }
            
            function moveBall() {
                // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω
                if (ball.x + ball.dx > canvas.width - ballRadius || ball.x + ball.dx < ballRadius) {
                    ball.dx = -ball.dx;
                }
                
                if (ball.y + ball.dy < ballRadius) {
                    ball.dy = -ball.dy;
                } else if (ball.y + ball.dy > canvas.height - ballRadius) {
                    // –û—Ç—Å–∫–æ–∫ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
                    if (ball.x > paddle.x && ball.x < paddle.x + paddleWidth) {
                        ball.dy = -ball.dy;
                    } else {
                        lives--;
                        
                        if (lives === 0) {
                            alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!');
                            document.location.reload();
                        } else {
                            ball.x = canvas.width / 2;
                            ball.y = canvas.height - 30;
                            ball.dx = 4;
                            ball.dy = -4;
                            paddle.x = (canvas.width - paddleWidth) / 2;
                        }
                    }
                }
                
                ball.x += ball.dx;
                ball.y += ball.dy;
            }
            
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                drawBricks();
                drawBall();
                drawPaddle();
                drawScore();
                drawLives();
                
                collisionDetection();
                movePaddle();
                moveBall();
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Right' || e.key === 'ArrowRight') {
                    rightPressed = true;
                } else if (e.key === 'Left' || e.key === 'ArrowLeft') {
                    leftPressed = true;
                }
            });
            
            document.addEventListener('keyup', function(e) {
                if (e.key === 'Right' || e.key === 'ArrowRight') {
                    rightPressed = false;
                } else if (e.key === 'Left' || e.key === 'ArrowLeft') {
                    leftPressed = false;
                }
            });
            
            function gameLoop() {
                draw();
                animationId = requestAnimationFrame(gameLoop);
            }
            
            gameLoop();
            
            return {
                stop: function() {
                    cancelAnimationFrame(animationId);
                }
            };
        }

        function loadDinoGame(container) {
            container.innerHTML = `
                <div id="dino-container">
                    <div id="dino"></div>
                    <div id="cactus"></div>
                </div>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ø—Ä–æ–±–µ–ª –∏–ª–∏ —Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö - –ø—Ä—ã–∂–æ–∫</p>
                <p id="dino-score">–°—á–µ—Ç: 0</p>
            `;
            
            const dino = document.getElementById('dino');
            const cactus = document.getElementById('cactus');
            const scoreDisplay = document.getElementById('dino-score');
            
            let isJumping = false;
            let isGameOver = false;
            let score = 0;
            let gameSpeed = 5;
            let cactusInterval;
            let scoreInterval;
            
            function jump() {
                if (isJumping || isGameOver) return;
                
                isJumping = true;
                let jumpHeight = 0;
                const jumpUp = setInterval(() => {
                    if (jumpHeight >= 150) {
                        clearInterval(jumpUp);
                        
                        // –ü–∞–¥–µ–Ω–∏–µ –≤–Ω–∏–∑
                        const fallDown = setInterval(() => {
                            if (jumpHeight <= 0) {
                                clearInterval(fallDown);
                                isJumping = false;
                                dino.style.bottom = '0';
                            } else {
                                jumpHeight -= 5;
                                dino.style.bottom = jumpHeight + 'px';
                            }
                        }, 20);
                    } else {
                        jumpHeight += 5;
                        dino.style.bottom = jumpHeight + 'px';
                    }
                }, 20);
            }
            
            function moveCactus() {
                let cactusPosition = 600;
                cactus.style.right = '0';
                
                const moveInterval = setInterval(() => {
                    if (cactusPosition <= 0) {
                        cactusPosition = 600;
                        cactus.style.right = '0';
                    } else if (
                        cactusPosition > 0 && cactusPosition < 80 &&
                        parseInt(dino.style.bottom || '0') < 50
                    ) {
                        // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ
                        clearInterval(moveInterval);
                        clearInterval(cactusInterval);
                        clearInterval(scoreInterval);
                        isGameOver = true;
                        alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ' + score);
                    } else {
                        cactusPosition -= gameSpeed;
                        cactus.style.right = (600 - cactusPosition) + 'px';
                    }
                }, 20);
                
                return moveInterval;
            }
            
            function updateScore() {
                score++;
                scoreDisplay.textContent = '–°—á–µ—Ç: ' + score;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∂–¥—ã–µ 100 –æ—á–∫–æ–≤
                if (score % 100 === 0) {
                    gameSpeed += 1;
                }
            }
            
            function startGame() {
                isGameOver = false;
                score = 0;
                gameSpeed = 5;
                scoreDisplay.textContent = '–°—á–µ—Ç: 0';
                
                cactusInterval = setInterval(moveCactus, 2000);
                scoreInterval = setInterval(updateScore, 100);
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', function(e) {
                if ((e.key === ' ' || e.key === 'ArrowUp') && !isGameOver) {
                    jump();
                }
                
                if (e.key === ' ' && isGameOver) {
                    startGame();
                }
            });
            
            startGame();
            
            return {
                stop: function() {
                    clearInterval(cactusInterval);
                    clearInterval(scoreInterval);
                    isGameOver = true;
                }
            };
        }

        function loadMinesweeperGame(container) {
            container.innerHTML = `
                <div style="text-align: center;">
                    <h3>–°–∞–ø–µ—Ä</h3>
                    <div style="margin: 10px 0;">
                        <button onclick="startMinesweeper(8, 8, 10)">–õ–µ–≥–∫–∏–π</button>
                        <button onclick="startMinesweeper(12, 12, 20)">–°—Ä–µ–¥–Ω–∏–π</button>
                        <button onclick="startMinesweeper(16, 16, 40)">–°–ª–æ–∂–Ω—ã–π</button>
                    </div>
                    <div id="minesweeper-board" style="display: inline-block; margin: 20px 0;"></div>
                    <p id="minesweeper-status">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</p>
                </div>
            `;
            
            const board = document.getElementById('minesweeper-board');
            const status = document.getElementById('minesweeper-status');
            
            let rows = 0;
            let cols = 0;
            let minesCount = 0;
            let revealedCount = 0;
            let minePositions = [];
            let boardData = [];
            let gameOver = false;
            
            function startMinesweeper(r, c, m) {
                rows = r;
                cols = c;
                minesCount = m;
                revealedCount = 0;
                minePositions = [];
                boardData = [];
                gameOver = false;
                
                board.innerHTML = '';
                board.style.gridTemplateColumns = `repeat(${cols}, 30px)`;
                board.style.display = 'grid';
                board.style.gap = '2px';
                
                status.textContent = `–û—Å—Ç–∞–ª–æ—Å—å –º–∏–Ω: ${minesCount}`;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å–∫–∏
                for (let i = 0; i < rows; i++) {
                    boardData[i] = [];
                    for (let j = 0; j < cols; j++) {
                        boardData[i][j] = {
                            isMine: false,
                            isRevealed: false,
                            isFlagged: false,
                            neighborMines: 0
                        };
                        
                        const cell = document.createElement('div');
                        cell.style.width = '30px';
                        cell.style.height = '30px';
                        cell.style.backgroundColor = '#ddd';
                        cell.style.display = 'flex';
                        cell.style.justifyContent = 'center';
                        cell.style.alignItems = 'center';
                        cell.style.cursor = 'pointer';
                        cell.dataset.row = i;
                        cell.dataset.col = j;
                        
                        cell.addEventListener('click', () => revealCell(i, j));
                        cell.addEventListener('contextmenu', (e) => {
                            e.preventDefault();
                            toggleFlag(i, j);
                        });
                        
                        board.appendChild(cell);
                    }
                }
                
                // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –º–∏–Ω
                let minesPlaced = 0;
                while (minesPlaced < minesCount) {
                    const row = Math.floor(Math.random() * rows);
                    const col = Math.floor(Math.random() * cols);
                    
                    if (!boardData[row][col].isMine) {
                        boardData[row][col].isMine = true;
                        minePositions.push({row, col});
                        minesPlaced++;
                    }
                }
                
                // –ü–æ–¥—Å—á–µ—Ç –º–∏–Ω –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–π –∫–ª–µ—Ç–∫–∏
                for (let i = 0; i < rows; i++) {
                    for (let j = 0; j < cols; j++) {
                        if (!boardData[i][j].isMine) {
                            let count = 0;
                            
                            for (let di = -1; di <= 1; di++) {
                                for (let dj = -1; dj <= 1; dj++) {
                                    if (di === 0 && dj === 0) continue;
                                    
                                    const ni = i + di;
                                    const nj = j + dj;
                                    
                                    if (ni >= 0 && ni < rows && nj >= 0 && nj < cols && boardData[ni][nj].isMine) {
                                        count++;
                                    }
                                }
                            }
                            
                            boardData[i][j].neighborMines = count;
                        }
                    }
                }
            }
            
            function revealCell(row, col) {
                if (gameOver || boardData[row][col].isRevealed || boardData[row][col].isFlagged) return;
                
                const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                boardData[row][col].isRevealed = true;
                
                if (boardData[row][col].isMine) {
                    // –ò–≥—Ä–æ–∫ –Ω–∞—Å—Ç—É–ø–∏–ª –Ω–∞ –º–∏–Ω—É
                    cell.style.backgroundColor = 'red';
                    cell.textContent = 'üí£';
                    gameOver = true;
                    revealAllMines();
                    status.textContent = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏.';
                } else {
                    revealedCount++;
                    cell.style.backgroundColor = '#fff';
                    
                    if (boardData[row][col].neighborMines > 0) {
                        cell.textContent = boardData[row][col].neighborMines;
                        // –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —á–∏—Å–µ–ª
                        const colors = ['', 'blue', 'green', 'red', 'darkblue', 'brown', 'teal', 'black', 'gray'];
                        cell.style.color = colors[boardData[row][col].neighborMines];
                    } else {
                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ –ø—É—Å—Ç—ã–µ –∫–ª–µ—Ç–∫–∏
                        for (let di = -1; di <= 1; di++) {
                            for (let dj = -1; dj <= 1; dj++) {
                                if (di === 0 && dj === 0) continue;
                                
                                const ni = row + di;
                                const nj = col + dj;
                                
                                if (ni >= 0 && ni < rows && nj >= 0 && nj < cols && !boardData[ni][nj].isRevealed) {
                                    revealCell(ni, nj);
                                }
                            }
                        }
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–±–µ–¥—É
                    if (revealedCount === rows * cols - minesCount) {
                        gameOver = true;
                        flagAllMines();
                        status.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–±–µ–¥–∏–ª–∏!';
                    }
                }
            }
            
            function toggleFlag(row, col) {
                if (gameOver || boardData[row][col].isRevealed) return;
                
                const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                
                if (boardData[row][col].isFlagged) {
                    boardData[row][col].isFlagged = false;
                    cell.textContent = '';
                    cell.style.backgroundColor = '#ddd';
                } else {
                    boardData[row][col].isFlagged = true;
                    cell.textContent = 'üö©';
                    cell.style.backgroundColor = '#ffeb3b';
                }
            }
            
            function revealAllMines() {
                minePositions.forEach(pos => {
                    const cell = document.querySelector(`[data-row="${pos.row}"][data-col="${pos.col}"]`);
                    if (!boardData[pos.row][pos.col].isFlagged) {
                        cell.textContent = 'üí£';
                        cell.style.backgroundColor = '#ff9999';
                    }
                });
            }
            
            function flagAllMines() {
                minePositions.forEach(pos => {
                    const cell = document.querySelector(`[data-row="${pos.row}"][data-col="${pos.col}"]`);
                    if (!boardData[pos.row][pos.col].isFlagged) {
                        boardData[pos.row][pos.col].isFlagged = true;
                        cell.textContent = 'üö©';
                        cell.style.backgroundColor = '#ffeb3b';
                    }
                });
            }
            
            // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é start –¥–æ—Å—Ç—É–ø–Ω–æ–π –≥–ª–æ–±–∞–ª—å–Ω–æ
            window.startMinesweeper = startMinesweeper;
            
            return {
                stop: function() {
                    // –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —ç—Ç–æ–π –∏–≥—Ä—ã
                }
            };
        }

        function loadFlappyGame(container) {
            container.innerHTML = `
                <canvas id="flappy-canvas" width="400" height="600"></canvas>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ø—Ä–æ–±–µ–ª –∏–ª–∏ –∫–ª–∏–∫ –º—ã—à—å—é - –ø—Ä—ã–∂–æ–∫</p>
                <p id="flappy-score">–°—á–µ—Ç: 0</p>
            `;
            
            const canvas = document.getElementById('flappy-canvas');
            const ctx = canvas.getContext('2d');
            const scoreDisplay = document.getElementById('flappy-score');
            
            const bird = {
                x: 100,
                y: 300,
                radius: 20,
                velocity: 0,
                gravity: 0.5,
                jump: -10
            };
            
            const pipes = [];
            const pipeWidth = 60;
            const pipeGap = 150;
            const pipeSpeed = 3;
            let pipeTimer = 0;
            let score = 0;
            let gameOver = false;
            let animationId;
            
            function drawBird() {
                ctx.beginPath();
                ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
                ctx.fillStyle = '#FFD700';
                ctx.fill();
            }
            
            function drawPipes() {
                ctx.fillStyle = '#4CAF50';
                pipes.forEach(pipe => {
                    // –í–µ—Ä—Ö–Ω—è—è —Ç—Ä—É–±–∞
                    ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
                    
                    // –ù–∏–∂–Ω—è—è —Ç—Ä—É–±–∞
                    ctx.fillRect(pipe.x, pipe.bottom, pipeWidth, canvas.height - pipe.bottom);
                });
            }
            
            function updateBird() {
                bird.velocity += bird.gravity;
                bird.y += bird.velocity;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –∑–µ–º–ª–µ–π –∏–ª–∏ –ø–æ—Ç–æ–ª–∫–æ–º
                if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
                    endGame();
                }
            }
            
            function updatePipes() {
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Ç—Ä—É–±
                pipeTimer++;
                if (pipeTimer > 100) {
                    const topHeight = Math.floor(Math.random() * (canvas.height - pipeGap - 100)) + 50;
                    pipes.push({
                        x: canvas.width,
                        top: topHeight,
                        bottom: topHeight + pipeGap,
                        passed: false
                    });
                    pipeTimer = 0;
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ —Ç—Ä—É–±
                for (let i = pipes.length - 1; i >= 0; i--) {
                    pipes[i].x -= pipeSpeed;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø—Ç–∏—Ü–µ–π
                    if (
                        bird.x + bird.radius > pipes[i].x &&
                        bird.x - bird.radius < pipes[i].x + pipeWidth &&
                        (bird.y - bird.radius < pipes[i].top || bird.y + bird.radius > pipes[i].bottom)
                    ) {
                        endGame();
                    }
                    
                    // –ü–æ–¥—Å—á–µ—Ç –æ—á–∫–æ–≤
                    if (!pipes[i].passed && bird.x > pipes[i].x + pipeWidth) {
                        pipes[i].passed = true;
                        score++;
                        scoreDisplay.textContent = '–°—á–µ—Ç: ' + score;
                    }
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä—É–± –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —ç–∫—Ä–∞–Ω–∞
                    if (pipes[i].x + pipeWidth < 0) {
                        pipes.splice(i, 1);
                    }
                }
            }
            
            function endGame() {
                gameOver = true;
                cancelAnimationFrame(animationId);
                alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ' + score);
            }
            
            function gameLoop() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                if (!gameOver) {
                    updateBird();
                    updatePipes();
                    
                    drawPipes();
                    drawBird();
                    
                    animationId = requestAnimationFrame(gameLoop);
                }
            }
            
            function jump() {
                if (gameOver) {
                    // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
                    bird.y = 300;
                    bird.velocity = 0;
                    pipes.length = 0;
                    pipeTimer = 0;
                    score = 0;
                    scoreDisplay.textContent = '–°—á–µ—Ç: 0';
                    gameOver = false;
                    gameLoop();
                } else {
                    bird.velocity = bird.jump;
                }
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            document.addEventListener('keydown', function(e) {
                if (e.key === ' ') {
                    jump();
                }
            });
            
            canvas.addEventListener('click', jump);
            
            gameLoop();
            
            return {
                stop: function() {
                    cancelAnimationFrame(animationId);
                    gameOver = true;
                }
            };
        }
    </script>
</body>
</html>
